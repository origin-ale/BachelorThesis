\chapter{Formulazioni della meccanica}
La meccanica classica si propone di studiare il moto dei corpi macroscopici in movimento con velocità trascurabile rispetto a quella della luce. In questo capitolo saranno esposte tre \emph{formulazioni} della meccanica classica, vale a dire tre modi per ricavare le equazioni del moto di un sistema. Dopo aver costruito un modello di universo classico e richiamato l'intuitiva ma scomoda formulazione \emph{newtoniana} basata sulle forze, si ricaverà la formulazione \emph{lagrangiana} dal principio di minima azione. Infine, grazie alla trasformata di Legendre, si passerà alla potente formulazione \emph{hamiltoniana}, che costituirà il fondamento per il resto della trattazione.

\section{Il modello classico dell'universo}
Per dare una formulazione assiomatica alla meccanica classica è innanzitutto necessario stabilire alcune caratteristiche dell'universo per quanto riguarda i corpi che si muovono su scala macroscopica (azione molto maggiore della costante di Planck $\hbar$) e a basse velocità (velocità molto minore di quella della luce $c$). Queste caratteristiche dovranno essere emulate dal modello di universo che ci si propone di costruire. Siccome l'ambito di applicazione di questo modello comprende l'esperienza quotidiana, è da essa che si può trarre spunto. Si pongono quindi i seguenti requisiti al modello:
\begin{enumerate}
  \item L'universo è composto da \emph{spazio e tempo}. Lo spazio è tridimensionale ed euclideo, il tempo è unidimensionale.
  \item  Gli eventi sono individuati nello spazio e nel tempo usando \emph{sistemi di coordinate}. Esistono sistemi, detti \emph{inerziali}, tali che:
  \begin{enumerate}
    \item A ogni istante, tutte le leggi della natura sono uguali in ogni sistema inerziale.
    \item Tutti i sistemi che si muovono di moto rettilineo e uniforme rispetto a un sistema inerziale sono inerziali.
  \end{enumerate}
  \item L'universo è popolato di \emph{particelle}, entità adimensionali dotate di una massa e una posizione. Esso è inoltre è \emph{newtonianamente deterministico}: l'insieme delle posizioni e delle velocità di tutte le particelle a un certo tempo determina tutto il loro moto, sia nel passato che nel futuro.
\end{enumerate}

Si desidera ora costruire un modello formale che presenti queste stesse caratteristiche. Per fare ciò, sarà necessaria una struttura matematica che formalizza l'idea di uno spazio-tempo in cui gli spostamenti sono vettori, ma non è definita un'origine. Tale struttura è nota come spazio affine.
\begin{definition}
  Uno \dfn{spazio affine $n$-dimensionale} è una struttura $(A,V,+)$ dove:
  \begin{itemize}
    \item $A$ è un insieme.
    \item $V$ è uno spazio vettoriale reale.
    \item $+:\, A\times V \to A$ è un'applicazion biunivoca detta \dfn{azione destra} di $V$ su $A$. L'immagine della coppia $(a,v)$ con $a \in  A, v \in V$ si denota con $a+v$.
  \end{itemize}
  La \dfn{dimensione} di $A$ è la dimensione di $V$.
\end{definition}
\begin{remark}
  Siccome $+$ è biunivoca, fissati $a,b \in A$ esiste uno e un solo $v \in V$ tale che $a + v = b$. Tale elemento di $V$ si denota con $v = b - a$. In tal modo, gli spostamenti (differenze) tra punti di $A$ sono effettivamente vettori.
\end{remark}
\begin{remark}
Fissato un $a \in A$, l'insieme dei $v$ tali che $v = b - a$ per un qualche $b \in A$ forma uno spazio vettoriale reale isomorfo a $V$. Si dice che $V = A - A$.
\end{remark}

È a questo punto possibile formulare le componenti centrali del nostro modello: l'universo, il tempo, gli eventi contemporanei e la distanza fra di essi. Queste andranno a formare una struttura detta galileiana.
\begin{definition}
  Una \dfn{struttura spazio-temporale galileiana} è composta da:
  \begin{enumerate}
    \item L'\dfn{universo}, uno spazio affine quadridimensionale $\mathbb{A}^4$ i cui punti sono detti \emph{eventi}.
    \item Il \dfn{tempo}, un'applicazione lineare $t:\mathbb{A}^4 - \mathbb{A}^4 \to \R$. Si dice \dfn{intervallo temporale} fra due eventi $a,b \in \mathbb{A}^4$ il numero reale $t(a-b)$. Se esso è nullo, $a$ e $b$ si dicono \dfn{contemporanei}.
    \item La \dfn{distanza fra eventi contemporanei} \begin{equation*}
    d(a,b) = \norm{a-b}_2 = \sqrt{\ev{a-b,a-b}}  
    \end{equation*} 
  \end{enumerate}
\end{definition}

Queste definizioni tuttavia non consentono ancora di formulare la meccanica classica. Non si ha infatti modo di identificare un punto nello spazio, siccome gli spazi di eventi contemporanei sono tutti separati tra loro. Per collegarli, si introduce l'ultima componente, i sistemi di riferimento.
\begin{definition}
  Si dice \dfn{sistema di riferimento} un'applicazione lineare biunivoca $\phi:\, \mathbb{A}^4 \to \R\times \R^3$. Un sistema di riferimento $\phi_1$ si dice \dfn{in moto uniforme} rispetto a $\phi_2$ se $\phi_1 \phi_2^{-1}: \R\times \R^3\to \R\times \R^3$ conserva intervalli temporali e distanze.
\end{definition}

Con quest'ultimo concetto si è finalmente in grado di descrivere posizioni e moti delle particelle che popolano l'universo.
\begin{definition}
  Si dice \dfn{moto} di una particella in un sistema di riferimento $\phi$ un'applicazione differenziabile $\vec{x}:I \to \R^3$, dove $I$ è un intervallo aperto in $\R$, che manda $t\mapsto \vec{x}(t)$. Si dice \dfn{posizione} del punto al tempo $t \in I$ il vettore $\vec{x}(t)$. Si dicono \dfn{velocità} e \dfn{accelerazione} del punto al tempo $t \in I$ le derivate rispettivamente prima e seconda della posizione \begin{equation*}
  \vec{\dot{x}} (t) = \dv{\vec{x}}{t}\, (t) \qqtext{e} \vec{\ddot{x}} (t) = \dv[2]{\vec{x}}{t}\, (t)
  \end{equation*} 
\end{definition}
\begin{remark}
  Velocità e accelerazione così definiti sono vettori del medesimo spazio vettoriale $\R^3$ a cui appartiene la posizione.
\end{remark}

Per descrivere le posizioni di $N$ particelle servono $N$ vettori a 3 componenti. La risultante struttura può essere identificata con un vettore del prodotto diretto di $N$ copie di $\R^3$. Questo vettore descrive la configurazione dell'intero sistema, il che motiva la seguente definizione.
\begin{definition}
  Si dice \dfn{spazio delle configurazioni} di un sistema di $N$ particelle il prodotto diretto di $N$ copie di $\R^3$: \begin{equation*}
  \mathbb{M} = \underbrace{\R^3 \times \R^3 \times \ldots \times \R^3}_{N \text{ volte}}
  \end{equation*} 
  \dfn{Moto, configurazione, velocità} e \dfn{accelerazione} di un tale sistema sono definite analogamente a quanto fatto per una sola particella, sostituendo $\R^3$ con $\mathbb{M}$.
\end{definition}

\section{Meccanica newtoniana}
Finora ci è occupati solo di come descrivere i moti delle particelle nell'universo. L'obiettivo della meccanica, tuttavia, è determinare in anticipo i moti di queste particelle sulla base di informazioni note, grazie al principio di determinismo newtoniano. Nella formulazione originaria, dovuta a Newton stesso, i moti delle particelle sono previsti in base alle forze che agiscono su di esse, determinate sperimentalmente, tramite la legge di Newton. In versione moderna, questa può essere formulata come segue.
\begin{newton}
  Siano $\mathbb{M}$ lo spazio delle configurazioni di un sistema e $I$ un intervallo reale aperto, se il sistema segue un moto $\vec{x}:I \to \mathbb{M}$ esiste una funzione $\vec{F}:\mathbb{M} \times \mathbb{M} \times  I \to \mathbb{M}$ tale che \begin{equation}
  \vec{\ddot{x}} = \vec{F}\,(\vec{x},\vec{\dot{x}}, t) \label{eq:newton}
  \end{equation} 
  Questa è detta \dfn{equazione di Newton} ed $\vec{F}$ è detta \dfn{forza} (generalizzata) agente sul sistema.
\end{newton}
\begin{remark}
  La funzione $\vec{F}$ si può ottenere dalla formulazione elementare della meccanica, che vede le forze come entità agenti su ciascuna particella in maniera distinta, moltiplicando la forza risultante su ciascuna particella per la massa di quest'ultima e concatenando i vettori risultanti.
\end{remark}
\begin{remark}
  La legge di Newton soddisfa il principio di determinismo grazie al teorema di esistenza e unicità di Cauchy: data la condizione iniziale, ovvero posizione e velocità del sistema a un tempo $t_0$, la soluzione dell'\autoref{eq:newton} esiste ed è unica nell'intervallo temporale $I$ in cui $\vec{F}$ è definita.
\end{remark}
La funzione $\vec{F}$ per un dato sistema fisico deve essere determinata sperimentalmente. Il modello matematico del sistema viene costruito nel momento in cui viene definita $\vec{F}$, motivo per cui essa è spesso identificata con il sistema stesso.

La conoscenza di $\vec{F}$ consente in linea di principio di conoscere il moto del sistema per qualsiasi posizione iniziale. Ciò tuttavia è molto più facile a dirsi che a farsi: per un sistema di $N$ particelle, questo metodo richiede di risolvere $3N$ equazioni differenziali, un processo che spesso è impossibile dal punto di vista analitico e inefficiente da quello numerico. È però possibile fare affermazioni qualitative sul moto dei corpi anche quando l'equazione del moto non è analiticamente risolvibile, attraverso i concetti legati all'energia.
\begin{definition}
  Si dice \dfn{energia cinetica di un sistema} formato da $N$ particelle di masse $m_i$ nelle posizioni $\vec{x}_i \in \R^3$ la quantità \begin{equation}
    T(\vec{\dot{x}}) = \sum_{i=1}^{N} \frac{1}{2}m_i\norm{\vec{\dot{x}}_i}^2
  \end{equation} 
\end{definition}
\begin{definition}
  Una forza dipendente solo dalle posizioni del sistema si dice \dfn{campo di forze}. Si dice \dfn{lavoro} del campo di forze $\vec{F}\, (x)$ sul cammino $\gamma \subset \mathbb{M}$ la quantità \begin{equation*}
  L = \int\limits_{\gamma} \vec{F}\,(\vec{x})\cdot \dd \vec{x}
  \end{equation*} 
  Un campo di forze e il corrispondente sistema si dicono \dfn{conservativi} se il lavoro del campo su un cammino qualsiasi non dipende dal cammino stesso. In tal caso, si dice \dfn{potenziale} rispetto a $\vec{x}_0 \in \mathbb{M}$ la quantità definita simbolicamente come \begin{equation}
  V(\vec{x}) = \int_{\vec{x}_0}^{\vec{x}} \vec{F}\,(\vec{x})\cdot \dd \vec{x}
  \end{equation} 
  dove l'integrale è compiuto lungo un qualsiasi percorso $\gamma$ di estremi $\vec{x}_0$ e $\vec{x}$.
\end{definition}
\begin{definition}
  Si dice \dfn{energia totale} di un sistema conservativo\begin{equation}
  E(\vec{x},\vec{\dot{x}}) = T(\vec{\dot{x}}) + V(\vec{x})
  \end{equation} 
\end{definition}
\begin{theorem} \label{thm:energyCons}
L'energia totale di un sistema conservativo è costante nel tempo.
\end{theorem}

Il \autoref{thm:energyCons} consente ad esempio di determinare la regione di spazio delle configurazioni ammessa per il moto di un sistema, date le condizioni iniziali.

\section{Meccanica lagrangiana}
La conservazione dell'energia di un sistema è un metodo piuttosto semplice per ottenere informazioni qualitative sul suo comportamento, ma queste non sono particolarmente dettagliate. La formulazione newtoniana è inoltre fortemente lineare: si è sostanzialmente forzati a usare le coordinate dello spazio vettoriale $\mathbb{M}$ per individuare un punto, anche quando il moto sarebbe più conveniente da descrivere attraverso altri sistemi di coordinate.

Si può ovviare a questi problemi attraverso la formulazione \dfn{lagrangiana} della meccanica, che ricava le equazioni del moto da una funzione scalare, non vettoriale come la forza generalizzata.

\begin{definition}
  Si dice \dfn{lagrangiana} di un sistema la funzione \begin{equation}
  \mathcal{L}(\vec{x},\vec{\dot{x}},t) = T(\vec{\dot{x}}) - V(\vec{x},t)
  \end{equation} 
  Si dice \dfn{azione} di un moto $\vec{x}:t\mapsto \vec{x}(t)$ l'integrale della lagrangiana nel tempo \begin{equation} \label{eq:action}
  S(t_0,t_1; \vec{x}) = \int_{t_0}^{t_1} \mathcal{L}(\vec{x}(t),\vec{\dot{x}}(t),t) \dd{t}
  \end{equation}
\end{definition}

Fissati un tempo iniziale e finale $t_0$ e $t_1$ e una configurazione iniziale e finale $\vec{x}_0$ e $\vec{x}_1$, l'azione è un funzionale definito sullo spazio dei moti $\vec{x}$ tali che $\vec{x}(t_0) = \vec{x}_0$ e $\vec{x}(t_1)=\vec{x}_1$. Per avere una formulazione della meccanica, è necessario un modo per determinare quale moto viene effettivamente realizzato. Intuitivamente, questo dovrebbe avere un qualche tipo di \textquotedblleft efficienza\textquotedblright: non dovrebbe seguire un percorso inutilmente lungo, né variare la sua velocità più del necessario. Queste idee intuitive sono raccolte in una formulazione matematica dal principio di minima azione, originariamente dovuto a Maupertuis.
\begin{minaction}
Il moto fisicamente realizzato da un sistema fra due punti nello spazio delle configurazioni è quello per cui l'azione è minima.
\end{minaction}
Siccome il principio di minima azione riguarda il moto nella sua interezza, il quale essendo un'applicazione differenziabile appartiene a uno spazio vettoriale infinito-dimensionale, il problema della determinazione pratica di quale sia effettivamente il moto lungo cui l'azione è minima necessita lo sviluppo del calcolo delle variazioni per essere risolto; nella presente monografia ci si limiterà a presentare il teorema che risulta da una trattazione completa.
% \begin{definition}
  %   Si dice \dfn{funzionale} un'applicazione tra uno spazio di funzioni differenziabili e l'asse reale.
  % \end{definition}
\begin{theorem}
  Affinché un moto $\vec{x}: t\mapsto \vec{x}(t)$ sia un minimo dell'azione $S(\vec{x})$ (definita dall'\autoref{eq:action}) fissati tempi e punti iniziali e finali $t_0, t_1, \vec{x}_0, \vec{x}_1$ è necessario che esso soddisfi le \dfn{equazioni di Eulero-Lagrange} \begin{equation}
    \dv{t}\Bigg[\pdv{\mathcal{L}}{\vec{\dot{x}}}()(\vec{x}, \vec{\dot{x}}, t)\Bigg] - \pdv{\mathcal{L}}{\vec{x}}()(\vec{x}, \vec{\dot{x}}, t) = 0
  \end{equation} 
  dove $\pdv{\vec{x}}$ indica il gradiente $\nabla_{\vec{x}}$.
\end{theorem}

È possibile dimostrare che, come si spera, i moti ottenute per un dato sistema meccanico dalla formulazione newtoniana e da quella lagrangiana coincidono. Come menzionato sopra, la formulazione lagrangiana semplifica però notevolmente i calcoli in molte situazioni. Un primo vantaggio è dovuto al fatto che essa consente di svolgere i calcoli non solo usando le componenti dei vettori di $\mathbb{M}$, ma anche con coordinate arbitrarie.

\begin{definition}
  In un sottoinsieme dello spazio delle configurazioni $U \subseteq \mathbb{M}$ si dicono \dfn{coordinate} $\vec{q}=(q_1, \ldots, q_n)$ le $n$-uple appartenenti a un insieme $W$ tale che esiste una funzione biunivoca $\phi: \vec{q} \in W \mapsto \vec{x}\in U$.
\end{definition}
\begin{remark}
  In generale, non è detto che $\vec{\dot{x}}$ dipenda solo da $\vec{\dot{q}}$: potrebbe dipendere anche da $\vec{q}$, come in effetti spesso è il caso.
\end{remark}
\begin{theorem}
  Un moto soddisfa le equazioni di Eulero-Lagrange in $\vec{x}$ se e solo se le soddisfa in coordinate $\vec{q}$ arbitrarie per $\mathbb{M}$: \begin{equation*}
    \dv{t}\Bigg[\pdv{\mathcal{L}}{\vec{\dot{q}}}()\big(\vec{x}(\vec{q}), \vec{\dot{x}}(\vec{q},\vec{\dot{q}}), t\big)\Bigg] - \pdv{\mathcal{L}}{\vec{q}}()\big(\vec{x}(\vec{q}), \vec{\dot{x}}(\vec{q},\vec{\dot{q}}), t\big) = 0
  \end{equation*} 
\end{theorem}

Questo significa che le equazioni del moto di un sistema ad esempio in coordinate polari possono essere ottenute immediatamente una volta scritte l'energia cinetica $T\big(\vec{\dot{x}}(\vec{q},\vec{\dot{q}})\big)$ e il potenziale $V\big(\vec{x}(\vec{q})\big)$ in coordinate polari.

Fra i casi più comuni in cui è naturale individuare una configurazione con coordinate non lineari vi sono i sistemi vincolati, ovvero che non sono liberi di occupare l'intero spazio vettoriale delle configurazioni. La meccanica lagrangiana è particolarmente adatta anche a questo caso specifico.

\begin{definition}
  Sia $\mathbb{M}$ uno spazio delle configurazioni di dimensione $n$ con coordinate arbitrarie $\vec{q} = (q_1, \ldots, q_n)$. Si dice \dfn{vincolo olonomo} la richiesta che il moto abbia un'immagine contenuta nel sottoinsieme $M$ di $\mathbb{M}$ definito da \begin{equation*}
    M = \left\{ a \in \mathbb{M} \left|\ \begin{cases} 
      F_1(\vec{q}) = 0 \\
      \vdots \\
      F_k(\vec{q}) = 0
    \end{cases} \right. \right\} \qqtext{con} \vec{q} = \phi^{-1}(a)
  \end{equation*} 
  dove $k \le n$ e $F_1, \ldots, F_k$ sono funzioni differenziabili da $\mathbb{M}$ a $\R$, tali che il rango della matrice $\pdv{F_i}{q_j}(a)$ sia $k$ in ogni $a \in M$. $M$ è detto \dfn{spazio delle configurazioni di un sistema vincolato}.
\end{definition}
\begin{remark}
  Lo spazio vincolato $M$ non è necessariamente uno spazio vettoriale, ma può essere un qualsiasi sottoinsieme di $\mathbb{M}$.
\end{remark}
\begin{remark}
  Un vincolo non olonomo, detto \dfn{anolonomo}, può vincolare anche la velocità del sistema. Non si parlerà qui di vincoli anolonomi, quindi nel seguito con \emph{vincolo} si intenderà \emph{vincolo olonomo}.
\end{remark}

Per utilizzare concretamente il concetto di vincolo, è necessario trovare una formalizzazione del meccanismo che restringe la regione ammessa di spazio delle configurazioni. Intuitivamente, un vincolo è un'entità che applica una forza infinita sul sistema quando esso tenta di uscire dallo spazio vincolato $M$. Le forze sono prerogativa della meccanica newtoniana, ma si può utilizzare un potenziale a pendenza tendente all'infinito lungo le direzioni che si allontanano dal vincolo. Esprimendo per il teorema del Dini le prime $k$ coordinate in funzione delle altre $n-k$ \begin{equation*}
\begin{cases}
  q_1 = f_1(q_{k+1}, \ldots, q_n) \\
  \vdots \\
  q_k = f_k(q_{k+1}, \ldots, q_n)
\end{cases}
\end{equation*} 
il potenziale che ci serve è \begin{equation*}
  V_{\alpha}(\vec{q}) = V(\vec{q}) + \alpha\big[(q_1-f_1)^2 + \ldots + (q_k-f_k)^2 \big] \qqtext{per} \alpha \to +\infty
\end{equation*} 
dove $V$ è il potenziale dello stesso sistema senza vincoli. Usando questo potenziale è possibile dimostrare il seguente teorema.
\begin{theorem}
  Sia $M \subset \mathbb{M}$ lo spazio delle configurazioni di un sistema vincolato con lagrangiana $\mathcal{L}_{\alpha} = T -V_{\alpha}$, siano date le condizioni iniziali $\vec{q}_0 \in  M$ e $\vec{\dot{q}}_0$ tangente a $M$ e sia $\vec{\phi}_{\alpha}(t)$ il moto del sistema. Allora esiste il limite \begin{equation*}
  \lim_{\alpha \to +\infty} \vec{\phi}_{\alpha}(t) = \vec{\psi}(t)
  \end{equation*} 
  e la funzione limite $\vec{q}(t) = \vec{\psi}(t)$ soddisfa le equazioni di Eulero-Lagrange \begin{equation*}
    \dv{t}\Bigg[\pdv{\mathcal{L}_{*}}{\vec{\dot{q}}}()(\vec{q},\vec{\dot{q}},t)\Bigg] - \pdv{\mathcal{L}_{*}}{\vec{q}}()(\vec{q},\vec{\dot{q}},t) = 0
  \end{equation*} 
  dove $\mathcal{L}_*$ è detta \dfn{lagrangiana ridotta} ed è definita come \begin{equation*}
  \mathcal{L}_*(\vec{q},\vec{\dot{q}}) = \eval{T(\vec{q},\vec{\dot{q}})\,}_{\begin{subarray}{l}
    q_1=f_1, \ldots, q_k=f_k \\
    \dot{q}_1, \ldots, \dot{q}_k = 0
  \end{subarray}} - \eval{V(\vec{q})\,}_{q_1=f_1, \ldots, q_k=f_k}
  \end{equation*} 
\end{theorem} 
Questo teorema consente in pratica di scrivere la lagrangiana esprimendo le coordinate vincolate in funzione delle altre, per poi calcolare le equazioni del moto solo per le coordinate non vincolate. 
\section{Meccanica hamiltoniana}
Le equazioni di Eulero-Lagrange sono di secondo ordine nelle coordinate $\vec{q}$, il che rende complicate operazioni come i cambi di variabili una volta scritta la lagrangiana. La formulazione \emph{hamiltoniana} consente invece di ottenere le equazioni del moto da equazioni di primo ordine. La formulazione hamiltoniana è sempre basata sul principio di minima azione, ma usa una diversa funzione scalare, detta hamiltoniana, che è legata alla lagrangiana da un'applicazione nota come trasformata di Legendre.

\begin{definition}
  Una funzione $f:\R^n \to \R$ si dice \dfn{convessa} se l'hessiana $\pdv{f}{x_i}{x_j}()(x)$ è definita positiva $\forall x \in \R^{n}$.
\end{definition}

\begin{definition}
  Data una funzione convessa $f:\R^{n}\to \R$, sia \begin{equation*}
  F(\vec{x},\vec{p}): \R^{n} \times (\R^{n})^* \to \R \qqtext{tale che} F(\vec{x},\vec{p}) = \vec{p}\vec{x} - f(x)
  \end{equation*} 
  e sia $\vec{x}(\vec{p})$ la funzione che a un vettore duale $\vec{p} \in (\R^{n})^*$ associa il valore di $\vec{x}$ tale che $F(\vec{x},\vec{p})$ è massimo. Si dice \dfn{trasformata di Legendre} di $f$ la funzione $f^*:(\R^{n})^* \to \R$ tale che \begin{equation*}
  f^*(\vec{p}) = F(\vec{x}(\vec{p}), \vec{p})
  \end{equation*} 
\end{definition}
\begin{remark} \label{rem:legendreDist}
  La funzione $F$ non è altro che la distanza verticale tra il punto del grafico di $f$ con coordinate $\vec{x}$ e il grafico del duale $\vec{p}$ (che nel caso multidimensionale è un piano a $n-1$ dimensioni passante per l'origine). 
\end{remark}
\begin{remark} \label{rem:legendreSlope}
  A $\vec{p}$ fissato, $F$ è massima quando $\pdv{F}{\vec{x}}=0$, da cui segue che nel punto $\vec{x}(\vec{p})$ vale \begin{equation*}
    \vec{p}=\pdv{f}{\vec{x}}()(\vec{x})
  \end{equation*}
\end{remark}
\begin{remark}
  Nel caso in cui $f$ è una funzione differenziabile definita sull'asse reale, siccome il grafico di un vettore duale $\vec{p} \in  (\R)^*$ è una retta passante per l'origine, l'\autoref{rem:legendreSlope} significa che $x(p)$ è il punto in cui la tangente al grafico di $f$ è parallela al grafico di $p$. Insieme all'\autoref{rem:legendreDist}, ciò implica che in questo caso $f^*(p)$ è l'intercetta della retta con pendenza $p$ tangente al grafico di $f$.
\end{remark}
\begin{remark}
  La trasformata di Legendre è comunque definita anche per funzioni convesse ma non differenziabili.
\end{remark}

Si possono a questo punto formulare le definizioni centrali di questo paragrafo.
\begin{definition}
  Si dice \dfn{hamiltoniana} $\mathcal{H}$ di un sistema con lagrangiana $\mathcal{L}$ espresso nelle coordinate $\vec{q}$ la trasformata di Legendre di $\mathcal{L}$ rispetto alle velocità generalizzate $\vec{\dot{q}}$. 
\end{definition}
\begin{remark}
  La condizione di convessità necessaria per la trasformata di Legendre è sempre soddisfatta per i sistemi meccanici conservativi, siccome l'energia cinetica è definita positiva e il potenziale non dipende dalle $\vec{\dot{q}}$.
\end{remark}

In meccanica hamiltoniana rivestono un'importanza fondamentale grandezze dette \emph{momenti}, che sono duali delle velocità e ne prendono il ruolo come variabili.
\begin{definition}
  Dato un sistema con lagrangiana $\mathcal{L}$ espresso nelle coordinate $\vec{q}=(q_1, \ldots, q_n)$, si dice \dfn{momento generalizzato} rispetto a $q_j$ la quantità \begin{equation}
  p_j(\dot{q}_j) = \pdv{\mathcal{L}}{\dot{q}_j}() (\dot{q}_j)
  \end{equation} 
\end{definition}
\begin{remark}
  La relazione $\vec{p}(\vec{q})$ può essere invertita per ottenere $\vec{q}(\vec{p})$.
\end{remark}

\begin{theorem}
  L'hamiltoniana di un sistema con lagrangiana $\mathcal{L}$ espresso nelle coordinate $\vec{q}=(q_1, \ldots, q_n)$ è data da \begin{equation*}
  \mathcal{H} = \left[\sum_{j=1}^{n} p_j \dot{q}_j (p_j)\right] - \mathcal{L}\big(\vec{q}, \vec{\dot{q}}(\vec{p}), t\big)
  \end{equation*} 
\end{theorem}

Come anticipato, le equazioni del moto possono essere ottenute dall'hamiltoniana risolvendo un sistema di equazioni di primo ordine.
\begin{theorem}
  Il moto seguito da un sistema fisico soddisfa le equazioni \begin{equation}
  \vec{\dot{q}}(\vec{q},\vec{p},t) = \pdv{\mathcal{H}}{\vec{p}}()(\vec{q},\vec{p},t) \qquad \vec{\dot{p}}(\vec{q},\vec{p},t) = -\pdv{\mathcal{H}}{\vec{q}}()(\vec{q},\vec{p},t)
  \end{equation}
  Esse sono dette \dfn{equazioni di Hamilton}.
\end{theorem}

\begin{theorem}
  Se la lagrangiana ha la forma $\mathcal{L} = T - V$, l'hamiltoniana non è altro che \begin{equation*}
  \mathcal{H}(\vec{q},\vec{p},t) = T\big(\vec{q},\vec{\dot{q}}(\vec{p})\big) + V(\vec{q},t)
  \end{equation*} 
  ovvero $\mathcal{H} = E$, l'energia totale.
\end{theorem}

La conservazione dell'energia totale si generalizza alla conservazione di qualsiasi hamiltoniana:
\begin{theorem}
  Se l'hamiltoniana $\mathcal{H}$ non dipende esplicitamente dal tempo $t$, le equazioni di Hamilton conservano $\mathcal{H}$.
\end{theorem}

In meccanica lagrangiana si codifica lo stato del sistema nello spazio delle configurazioni, con la velocità data dall'evoluzione a partire dalle condizioni iniziali; in meccanica hamiltoniana è necessario usare un altro tipo di spazio, lo spazio delle fasi, che include anche i momenti generalizzati.
\begin{definition}
  Si dice \dfn{spazio delle fasi} $X$ lo spazio di tutte le possibili coppie di posizione e momento generalizzato $(\vec{q},\vec{p})$.
\end{definition}
\begin{remark}
  Se il sistema non è vincolato, le sue posizioni appartengono allo spazio delle configurazioni $\mathbb{M}$ isomorfo a un qualche $\R^{n}$, e dunque anche i momenti appartengono a $(\R^{n})^*$ isomorfo a $\R^{n}$. Lo spazio delle fasi è quindi isomorfo a $\R^{2n}$.
\end{remark}

\begin{definition}
  Per un sistema non vincolato, con hamiltoniana $\mathcal{H}$, si dice \dfn{campo vettoriale hamiltoniano} \begin{equation*}
    \vec{V}_{\mathcal{H}}\,(\vec{z}) = -\mathsf{J}\; \grad{\mathcal{H}} (\vec{z})
  \end{equation*}
  dove $\vec{z}=(\vec{q},\vec{p})$, $\grad$ rappresenta il gradiente totale sullo spazio delle fasi \begin{equation*}
    \grad = \Bigg(\pdv{\vec{q}},\pdv{\vec{p}}\Bigg) 
    \end{equation*}
    e $\mathsf{J}$ è una matrice a blocchi data da \begin{equation*}
    \mathsf{J} = \bmqty{0 & -\mathsf{I} \\ \mathsf{I} & 0}
    \end{equation*}
    dove $\mathsf{I}$ è la matrice identità.
\end{definition}

In tal modo le equazioni di Hamilton prendono la forma \begin{equation*}
\vec{\dot{z}} = \vec{V}_{\mathcal{H}}\, (\vec{z}) 
\end{equation*} 
da cui risulta che
\begin{theorem}
  Il moto di un sistema non vincolato è la linea di flusso del campo vettoriale hamiltoniano che ha inizio nelle condizioni iniziali $(\vec{q}_0, \vec{p}_0)$.
\end{theorem} 

Definendo il moto in termini di flusso di un campo vettoriale, si sono quasi rimosse le coordinate dalla meccanica di un sistema non vincolato: il comportamento delle linee di flusso ne è indipendente, così come il campo vettoriale. Esse sono rimaste soltanto nella definizione dell'hamiltoniana. Questa formulazione della meccanica è il punto da cui si partirà per rimuovere completamente le coordinate dalla definizione dei sistemi meccanici e dei loro moti. Tuttavia, nel caso di sistemi generici, che possono anche essere vincolati e quindi avere proprietà topologiche non banali, sarà necessario impostare la teoria delle varietà differenziabili, con la quale si descriveranno geometricamente gli spazi delle fasi. Questo sarà l'oggetto del prossimo capitolo.