\chapter{Varietà differenziabili}
La teoria delle varietà differenziabili si occupa di generalizzare le caratteristiche geometriche di $\R^n$ a spazi con topologie diverse. In questo capitolo si daranno per prima cosa le definizioni di varietà differenziabile e di applicazione differenziabile fra varietà. Si definiranno poi i vettori tangenti e cotangenti sulle varietà, mostrandone il collegamento alle operazioni di derivazione e definendo spazi tangenti e cotangenti. Infine ci si occuperà delle forme differenziali, che forniranno il fondamento della formulazione simplettica della meccanica.

\section{Varietà e applicazioni differenziabili} \label{sec:smoothMfd}
Gli elementi di uno spazio vettoriale possono essere individuati tramite coordinate lineari. Una struttura di varietà differenziabile consente invece di individuare gli elementi di un insieme con coordinate non lineari, espandendo di molto i tipi di insiemi su cui è possibile definire coordinate. La non linearità complica però notevolmente l'individuazione dei punti, e rende necessario l'avere più di un sistema di coordinate. Sono inoltre posti alcuni requisiti per evitare casi patologici.

\begin{definition}
  Si dice \dfn{varietà differenziabile} una struttura $(X,\mathcal{U})$ dove $X$ è un insieme e $\mathcal{U}$, detto \dfn{atlante}, è una collezione di coppie $(U_{\nu}, \phi_{\nu})$ per $\nu \in S \subset \R$, dette \dfn{carte di coordinate}, dove gli $U_{\nu}$ sono sottoinsiemi di $X$ e le $\phi_{\nu}:U_{\nu}\to \R^{n}$ sono applicazioni biunivoche su un sottoinsieme aperto di $\R^{n}$ detto $\phi_{\nu}(U_{\nu})$, tali che:
  \begin{enumerate}
    \item le carte siano \dfn{compatibili}, cioè se $U_{\nu} \cap U_{\mu} \neq \emptyset$ allora $\phi_{\nu}(U_{\nu} \cap U_{\mu})$ e $\phi_{\mu}(U_{\nu} \cap U_{\mu})$ sono aperti nelle rispettive versioni di $\R^{n}$ e l'applicazione $\phi_{\mu} \circ \phi_{\nu}^{-1}: \phi_{\nu}(U_{\nu} \cap U_{\mu}) \to \phi_{\mu}(U_{\nu} \cap U_{\mu})$ è differenziabile fra questi due sottoinsiemi aperti di $\R^{n}$. $\identity_{\nu\mu} = \phi_{\mu} \circ \phi_{\nu}^{-1}$ è detta \dfn{mappa di transizione} fra le carte $\phi_{\nu}$ e $\phi_{\mu}$.
    \item esista un sottoinsieme numerabile $J \subset S$ tale che $X = \bigcup_{j \in  J} U_j$.
    \item Definendo \dfn{aperti in $X$} i sottoinsiemi di $X$ la cui immagine è aperta sotto tutte le carte nel cui dominio sono inclusi, $X$ sia uno spazio di Hausdorff, ossia per ogni $x,y \in X$ con $x \neq y$ esistano due insiemi aperti $U_x, U_y \subset X$ tali che $x \in U_x$ e $y \in  U_y$ mentre $U_x \cap U_y = \emptyset$.
  \end{enumerate}
   Dato che non saranno considerati altri tipi di varietà, l'aggettivo \emph{differenziabile} sarà omesso nel seguito. Si indicherà inoltre la varietà $(X,\mathcal{U})$ semplicemente come $X$.
\end{definition}
\begin{remark}
  Si noti che, per come sono definite qui, le $\phi_{\nu}$ associano \emph{a un elemento della varietà una $n$-upla di reali}, e non viceversa. Siccome le $\phi_{\nu}$ sono biunivoche per definizione, tuttavia, è possibile riottenere i punti della varietà note le loro coordinate.
\end{remark}
\begin{remark}
  È possibile aggiungere nuove carte all'atlante $\mathcal{U}$ senza cambiare la struttura di varietà se queste nuove carte sono compatibili con le vecchie. Se un atlante non ammette nuove carte compatibili, esso è detto \dfn{massimale}. Spesso si assumerà che sia questo il caso.
\end{remark}
\begin{remark}
  Definendo gli aperti come al punto $3$, una varietà differenziabile ha una topologia naturale. In questa topologia, tutte le carte sono mappe continue (la retroimmagine di ogni aperto è aperta) per definizione. Viceversa, uno spazio topologico ha una struttura di varietà differenziabile, scegliendo gli $U_{\nu}$ fra gli aperti, se è possibile ricoprire $X$ di aperti e scegliere i $\phi_{\nu}$ in modo che siano omeomorfismi con $\R^{n}$.
\end{remark}
\begin{remark}
  La topologia naturale rende possibile determinare quando una varietà è connessa. Se $X$ è una varietà connessa, la dimensione $n$ di $\R^{n}$ codominio di una $\phi$ appartenente a una carta è lo stesso per ogni $\phi$. In tal caso, $n$ si dice \dfn{dimensione} di $X$. Nel seguito, saranno considerate solo varietà connesse.
\end{remark}

Data una carta $(U,\phi)$ e un punto $x \in U$, spesso per brevità si indicano le componenti $\big(\phi_1(x), \ldots, \phi_{n}(x)\big)$ con $(x_1, \ldots, x_n)$, identificando sostanzialmente $U$ con $\phi(U)$. Spesso si assume anche, senza perdita di generalità, che $\phi$ sia stata traslata in modo che per un qualche $x_0 \in  U$ si abbia $\phi(x_0) = 0$. 

Definito il teatro della teoria, restano da definire le azioni che in essa si possono compiere, vale a dire le applicazioni differenziabili da una varietà a un'altra.
\begin{definition}
  Un'applicazione $f:X \to Y$ tra varietà $X, Y$ si dice \dfn{differenziabile} se per ogni $x \in  X$ esistono una carta $(U, \phi)$ su $X$ con $x \in U$ e una carta $(V, \psi)$ su $Y$ tali che $f(U) \subset V$ e $\psi \circ f \circ \phi^{-1}: \phi(U) \to \psi(V)$ sia una funzione differenziabile tra sottoinsiemi di $\R^{n}$. $f_{\phi \psi} = \psi \circ f \circ \phi^{-1}$ è detta \dfn{rappresentazione in coordinate} dell'applicazione $f$. $f$ si dice inoltre \dfn{diffeomorfismo} se anche la sua inversa è differenziabile. 
\end{definition}
\begin{remark}
  Se $f$ è differenziabile, allora è anche continua fra le topologie naturali delle due varietà. In tal caso infatti ogni sottoinsieme aperto di $Y$ ha come retroimmagine un sottoinsieme aperto di $X$, dato che ogni punto $x$ di questa retroimmagine ammette un intorno aperto $U$.
\end{remark}

Nel caso, specifico ma significativo, in cui $f$ sia a valori reali, ovvero $Y = \R$, $Y$ ha un'unica carta $(\R, \identity)$ (dove $\identity$ è l'identità) e la definizione diventa la seguente.
\begin{definition}
  Un'applicazione a valori reali definita su una varietà $f:X\to \R$ si dice \dfn{differenziabile} se per ogni $x \in X$ esiste una carta $(U, \phi)$ su $X$ con $x \in  U$ tale che $f\circ \phi^{-1}: \phi(U) \to \R$ sia una funzione differenziabile tra sottoinsiemi di $\R^{n}$.
\end{definition}

Un modo naturale per produrre nuove varietà è prendere il prodotto cartesiano di varietà già definite. Si può infatti dimostrare il seguente teorema.
\begin{theorem}
  Se $X$ e $Y$ sono varietà con struttura data dalle carte $\big\lbrace(U_{\mu}, \phi_{\mu})\big\rbrace$, con $\mu \in R \subset \R$, e $\big\lbrace (V_{\nu}, \psi_{\nu})\big\rbrace$, con $\nu \in S \subset  \R$, il prodotto cartesiano $X \times Y$ ha una struttura naturale di varietà data dalle carte $\Big\lbrace\big( U_{\mu} \times V_{\nu}, (\phi_{\mu},\psi_{\nu})\big)\Big\rbrace$, dove $\mu \in  R,\ \nu \in S$ e \begin{equation*}
    \big((\phi_{\mu},\psi_{\nu})\big): (x,y) \mapsto \bigg(\big(\phi_{\mu}(x),\psi_{\nu}(y)\big)\bigg) \qqtext{per} x \in U_{\mu},\ y \in  V_{\nu}
  \end{equation*} 
\end{theorem}
\begin{remark}
  In sostanza, la varietà prodotto ha per punti le coppie di punti e per coordinate le coppie di coordinate delle due varietà fattore.
\end{remark}

\section{Vettori tangenti}
Per poter definire una forma di calcolo differenziale sulle varietà, è necessario formalizzare la nozione di spostamento infinitesimo, definendo i vettori tangenti.

\begin{definition}
  Si dice \dfn{vettore tangente} alla varietà $X$ nel punto $x \in  X$ la classe di equivalenza $[\gamma]$, dove $\gamma:]-\epsilon,\epsilon\;[\ \to X$, con $\epsilon > 0$, è un cammino differenziabile con $\gamma(0) = x$ e $\gamma_1$ equivale a $\gamma_2$ se esiste una carta $(U, \phi)$ tale che \begin{equation*}
  \eval{\dv{t} \phi \big(\gamma_1(t)\big)}_{t=0} = \eval{\dv{t} \phi\big(\gamma_2(t)\big)}_{t=0}
  \end{equation*} 
  L'insieme dei vettori tangenti a $X$ in $x$ si dice \dfn{spazio tangente} a $X$ in $x$ e si indica con $T_x X$.
\end{definition}
\begin{remark}
  Intuitivamente, un vettore tangente in $x \in X$ è definito come un cammino infinitesimo che attraversa $x$ con una certa velocità. La relazione di equivalenza rimuove dalla considerazione il dominio di definizione e il comportamento nei punti diversi da $x$.
\end{remark}
Nel seguito, quando non necessario per evitare ambiguità, si ometteranno le parentesi quadre dalla notazione per le classi di equivalenza, scrivendo $\gamma$ al posto di $[\gamma]$.

Lo spazio tangente a $\R^{n}$ in un qualsiasi punto $y \in \R^{n}$, denotato $T_y \R^{n}$, può essere identificato con $\R^{n}$ facendo corrispondere a ogni $v \in \R^{n}$ la classe di equivalenza del cammino $\gamma_v(t) = y + tv$. Siccome qualsiasi cammino $\gamma_0:]-\epsilon,\epsilon\;[\ \to X$, con $\epsilon > 0$ e $\gamma_0(0)=y$, ammette nella sua classe di equivalenza (si ricordi che in $\R^{n}$ $\phi = \identity$) il cammino $\gamma(t) = y + t\dot{\gamma}_0(0)$ e quindi corrisponde a un $v_{\gamma} = \dot{\gamma}_0(0) \in \R^{n}$, la corrispondenza è suriettiva. Dato che è anche iniettiva per definizione, essa è biunivoca. 

Inoltre, una carta $(U, \phi)$ intorno a un punto $x \in  X$, con $X$ varietà generica di dimensione $n$, fornisce un modo di identificare $T_x X$ con $\R^{n}$, associando a ogni $v \in \R^{n}$ il percorso su $U$ \begin{equation} \label{eq:tangentRn}
  \gamma_{v}(t) = \phi^{-1}(\phi(x)+tv) \qqtext{per} t \in ]-\epsilon, \epsilon[ \qqtext{con} \epsilon > 0
\end{equation} Analogamente a sopra, questa corrispondenza è infatti biunivoca, con \begin{equation*} \label{eq:tangentCoords}
v_{\gamma} = \eval{\dv{t} \phi\big( \gamma_0(t)\big)}_{t=0}
\end{equation*} Ogni spazio tangente può quindi essere identificato con $\R^{n}$. Da ciò segue che ogni spazio tangente è uno spazio vettoriale. Una sua base è \begin{equation} \label{eq:tangentRnBase}
  \big\lbrace\phi^{-1}(\phi(x)+t\, e_i)\big\rbrace \qqtext{per} i=1, \ldots, n
\end{equation}
dove $e_i$ è l'$i$-esimo elemento della base canonica di $\R^{n}$ e i cammini sono da intendersi come classi di equivalenza.

Si consideri ora lo spazio delle derivazioni in $\R^{n}$, ovvero degli operatori $\pdv{\hat{\nu}}$ definiti sulle funzioni $f: \R^{n} \to \R$ come 
\begin{equation*}
  \pdv{\hat{\nu}}: f \mapsto \pdv{f}{\hat{\nu}}(x) = \lim_{\epsilon \to 0} \frac{f(x+\epsilon \hat{\nu})-f(x)}{\epsilon}
\end{equation*}
Esso è uno spazio vettoriale e possiede una base costituita dalle derivate direzionali lungo i vettori della base canonica
\begin{equation*}
\pdv{x_i} = \lim_{\epsilon \to 0} \frac{f(x+\epsilon e_i)-f(x)}{\epsilon} \qqtext{per} i=1, \ldots, n
\end{equation*}
Data $f:\R^{n} \to \R$, per l'$i$-esimo cammino di base è possibile considerare il suo punto per $t = \epsilon$, cioè $\phi^{-1}(\phi(x) + \epsilon e_i)$, e il rapporto incrementale in $\R^{n}$
\begin{equation*}
\lim_{\epsilon \to 0} \frac{f\, \bigg[\phi \Big(\phi^{-1}\big(\phi(x) + \epsilon e_i\big)\Big)\bigg] - f\,\big[\phi(x)\big]}{\epsilon}
\end{equation*}
che non è altro che la definizione di $\pdv{f}{x_i}$. Data una carta, è quindi possibile far corrispondere a ogni elemento della base dei cammini un elemento della base delle derivate direzionali in $\R^{n}$, in maniera univoca. Gli spazi delle derivazioni su $\R^{n}$ e tangente a una varietà di dimensione $n$ sono quindi isomorfi e possono essere identificati, facendo corrispondere a ogni cammino infinitesimo il rapporto incrementale fra le immagini di un suo estremo e del suo centro attraverso la carta.

È possibile estendere il concetto di campo vettoriale alle varietà: intuitivamente, un campo vettoriale associa a ogni punto un vettore tangente in quel punto, in maniera differenziabile.
\begin{definition} \label{def:vecField}
  Si dice \dfn{campo vettoriale} su una varietà $X$ un'applicazione $V: x \in  X \mapsto V (x) \in T_x X$, tale che per ogni $x \in X$ e per ogni carta $(U, \phi)$ con $x \in U$ sia differenziabile la mappa $V_\phi:U \to \R^{n}$ risultante per ciascun $y \in  U$ dall'identificazione di $T_y X$ con $\R^{n}$ data da $\phi$ secondo l'\autoref{eq:tangentRn}.
\end{definition}

Le identificazioni locali consentono di scrivere localmente i campi vettoriali su varietà come campi vettoriali su $\R^{n}$, una volta fissata una carta. In un cambio di carta, le componenti dei vettori tangenti si trasformano in maniera ben definita.
\begin{theorem} 
  Sia $X$ una varietà e siano $(U,\phi)$ e $(V,\psi)$ due carte. Sia $x \in  U \cap V$ e sia $\gamma \in  T_x X$. Siano $u \in \R^{n}$ e $v \in  \R^{n}$ i corrispondenti di $\gamma$ secondo $\phi$ e $\psi$ (\autoref{eq:tangentRn}), rispettivamente. Allora, identificando $x_i = \phi_i$, dette $u_j$ e $v_i$ le componenti di $u$ e $v$, e detta $F^{\phi\psi}:\R^{n} \to \R^{n}$ la funzione di transizione, con componenti $F^{\phi \psi}_i$, vale \begin{equation} \label{eq:vecTrans}
  v_i = \sum_{j=1}^n \pdv{F^{\phi \psi}_i}{x_j}\big(\phi(x)\big)\; u_j
  \end{equation} 
\end{theorem}

Se si rappresentano i vettori tangenti a una varietà con le derivazioni in $\R^{n}$, i campi vettoriali su quella varietà hanno forma 
\begin{equation*}
  V_x = \sum_{j=1}^{n} a_j(x) \pdv{x_j}
\end{equation*} 
e, indicando la funzione di transizione con $\vec{y}(\vec{x})$, l'\autoref{eq:vecTrans} ha forma 
\begin{equation*}
  \pdv{y_i} = \sum_{j=1}^{n} \pdv{x_j}{y_i} \pdv{x_j}
\end{equation*} 
ovvero si recupera la regola della catena in $\R^{n}$.

I vettori tangenti consentono di individuare spostamenti infinitesimi su una varietà, e rendono quindi possibile la formulazione e la risoluzione di equazioni differenziali.

\begin{definition}
  Sia $X$ una varietà, un'applicazione $x:\R \to X$ si dice \dfn{linea di flusso} per un campo vettoriale $V$ su $X$ se soddisfa l'equazione \begin{equation*}
  \dot{x}(t) = V\big(x(t)\big)
  \end{equation*} 
  dove $\dot{x}$ è il vettore tangente in $x(t)$ definito da $[x]$, con il tempo opportunamente traslato.
\end{definition}
\begin{remark}
  Scelta una carta, questa equazione equivale a un'equazione di primo grado, la cui soluzione per una data condizione iniziale esiste ed è unica per via del teorema di Cauchy. Si dimostra quindi il seguente teorema.
\end{remark}
\begin{theorem}
  Sia $X$ una varietà compatta (cioè in cui ogni successione ammette una sottosuccessione convergente) e sia $V$ un campo vettoriale su $X$. Allora esistono un $\epsilon > 0$ e un'applicazione differenziabile $\Phi:]-\epsilon, \epsilon\;[\ \times X \to X$, detta \dfn{flusso del campo vettoriale}, tale che \begin{equation*}
  \dv{t} \Phi(t,x) = V\big( \Phi(x,t)\big) \quad \forall\, x \in  X
  \end{equation*} 
  Inoltre, la mappa $\Phi^t(x):X \to X$ definita da $\Phi^t:x \mapsto \Phi(t,x)$ è un diffeomorfismo di $X$ in se stesso.
\end{theorem}

Gl spazi tangenti a una varietà si possono raccogliere in una struttura detta fibrato tangente, che è anch'essa una varietà.

\begin{definition} \label{def:tanBundle}
  Sia $X$ una varietà, si dice \dfn{fibrato tangente} $TX$ l'insieme delle coppie $(x,\gamma)$ con $x \in X$ e $\gamma \in T_x X$, con l'atlante dato dalle carte $(U, \Phi)$ definite nel seguente modo. Sia $(U, \phi)$ una carta su $X$ e sia $T_U X$ l'insieme delle coppie $(x,\gamma)$ con $x \in X$ e $\gamma \in T_x X$. Allora $\Phi:T_U X \to \phi(U) \times \R^{n}$ è definita come \begin{equation}
  \Phi \big(x,\gamma\big) = \big(\phi(x), v\big)
  \end{equation} 
  dove $v \in \R^{n}$ è il vettore reale corrispondente a $\gamma$ secondo la carta $\phi$ (\autoref{eq:tangentCoords}).
\end{definition}

Queste varietà vengono dette fibrati per analogia al caso della circonferenza, in cui ogni punto possiede una \textquotedblleft fibra\textquotedblright\ monodimensionale come spazio tangente. Da un elemento dello spazio tangente si può sempre rimuovere la fibra.
\begin{definition}
  Sia $X$ una varietà e $T X$ il suo fibrato tangente. Si dice \dfn{proiezione} del fibrato tangente su $X$ l'applicazione $\pi: TX \to X$ definito per ogni $x \in X$ e $\gamma \in T_x X$ da $\pi(x,\gamma) = x$.
\end{definition}

Un'altra possibilità che i vettori tangenti consentono di espandere da $\R^{n}$ alle varietà in generale è la derivazione.
\begin{definition}
  Siano $X,Y$ varietà e sia $f:X\to Y$ un'applicazione differenziabile. Si dice \dfn{derivata} o \dfn{push-forward} di $f$ in $x \in X$ l'applicazione lineare $D_x f:T_x X \to T_{f(x)}Y$ che porta il cammino $\gamma: ]-\epsilon, \epsilon\;[\ \to X$ con $\epsilon>0$ e $\gamma(0) \in X$ nel cammino $f \circ \gamma:]-\epsilon, \epsilon\;[\ \to Y$.
\end{definition}
\begin{remark}
  Intuitivamente, la derivata dell'applicazione $f$ in un punto $x \in X$ associa a ogni spostamento infinitesimo da $x$ lo spostamento infinitesimo da $f(x) \in Y$ che ne risulta.
\end{remark}
\begin{remark}
  Questa definizione di derivata generalizza la derivata direzionale. Se infatti $X = \R^{n}$ e $Y = \R^{m}$, a un vettore $v \in \R^{n}$ si può associare un percorso $x + tv$. La derivata manda questo percorso in $f(x+tv)$, a cui si può associare $w = \eval{\dv{t}(x+tv)}_{t=0}$ e quest'ultima è esattamente la definizione di derivata direzionale. Nel caso di $X,Y$ varietà generiche, ci si può ricondurre al caso $\R^{n} \to \R^{m}$ tramite le carte di coordinate intorno a $x \in X$ e $f(x)\in Y$, rispettivamente $(U, \phi)$ e $(V,\psi)$. In tal caso, la derivata è rappresentata dal jacobiano di $f_{\phi \psi}$, la rappresentazione in coordinate di $f$.
\end{remark}
\begin{remark}
  La derivata è chiamata anche \emph{push-forward} perché \emph{spinge} i vettori tangenti dalla varietà dominio alla varietà codominio di $f$. 
\end{remark}

\begin{remark}
  Se il vettore tangente è identificato con una derivazione $\partial$, essa si trasforma nella derivazione $f^*_x \partial$ tale che per ogni $g:X\to \R$
  \begin{equation*}
    (f^*_x \partial)g = \partial (g \circ f) 
  \end{equation*} 
\end{remark}

\section{Vettori cotangenti}
Se $f:X \to \R$ è una funzione differenziabile a valori reali, per ogni $x \in X$ si ha che $D_x f: T_x X \to T_{f(x)}\R$, ma siccome $T_{f(x)}\R$ può essere identificato con $\R$ si può scrivere $D_x f: T_x X \to \R$. Ciò significa che la derivata di una funzione a valori reali appartiene allo spazio duale di quello tangente.

\begin{definition}
  Sia $X$ una varietà e sia $x \in X$. Si dice \dfn{spazio cotangente} a $X$ in $x$ $T_x^* X$ lo spazio duale di $T_x X$. I suoi elementi si dicono \dfn{vettori cotangenti}.
\end{definition}
\begin{remark} \label{rem:dualBasis}
  Siccome lo spazio cotangente è uno spazio duale, esso è automaticamente uno spazio vettoriale. Per lo stesso motivo le sue basi sono le basi duali di quelle dello spazio tangente, tra cui per una data carta $(U, \phi)$ $\{D_x \phi_1, \ldots, D_x \phi_n\} $, che è la base duale di quella definita dall'\autoref{eq:tangentRnBase}.
\end{remark}

Se si rappresentano i vettori tangenti come derivazioni su $\R^{n}$, i vettori cotangenti saranno rappresentati da oggetti appartenenti allo spazio duale di quello delle derivazioni. Oggetti di questo genere sono i \dfn{differenziali (in $\R^{n}$)}, definiti nel seguente modo.
\begin{definition}
  Sia $f:\R^{n}\to \R$ una funzione e sia $y \in \R^{n}$. Si dice \dfn{$\R^{n}$-differenziale} di $f$ in $y$ l'applicazione $d_y f:\text{Der}|_y\, \R^{n} \to \R$ tale che \begin{equation*}
  (d_y f)\left(\pdv{x_i}\right) = \pdv{f}{x_i}()(y)
  \end{equation*} 
\end{definition}
\begin{remark}
  Questa definizione si riconduce a quella nota dall'analisi, secondo cui $(d_y f)(\vec{v}) = \grad{f}(y) \cdot \vec{v}$ identificando ogni derivata direzionale con il vettore di base corrispondente. In tal caso infatti 
  \begin{equation*}
    (d_y f)\left(\pdv{x_i}\right) = (d_y f)(\vec{e}_i) = \grad{f}(y) \cdot \vec{e}_i = \pdv{f}{x_i}()(y)
  \end{equation*} 
\end{remark}

Così come è possibile costruire campi vettoriali su una varietà, è anche possibile costruirvi \textquotedblleft campi di $1$-forme\textquotedblright.
\begin{definition} \label{def:1formCvc}
  Si dice \dfn{1-forma differenziale} su una varietà $X$ un'applicazione $\alpha: x \in X \mapsto \alpha(x) \in T_x^* X$, differenziabile in senso analogo a quello usato per i campi vettoriali nella \autoref{def:vecField} (cioè tale che si ottenga un'applicazione differenziabile identificando gli spazi tangenti con $\R^{n}$ secondo le carte di coordinate).
\end{definition}

L'applicazione che a ogni punto associa la derivata di una funzione $f$ fissata in quel punto è una 1-forma differenziale.
\begin{definition} \label{def:differential}
  Sia $X$ una varietà e sia $f:X\to \R$ un'applicazione differenziabile, si dice \dfn{differenziale} di $f$ la 1-forma differenziale \begin{equation}
  \dd f: x \in X \mapsto D_x f \in T_x^* X
  \end{equation} 
\end{definition}
\begin{remark}
  Nel seguito si indicherà la $1$-forma data dal differenziale di $f$ valutato in $y$ come $\dd_y f:T_y X \to \R$.
\end{remark}
\begin{remark}
  La base duale dell'\autoref{rem:dualBasis} è $\{ \dd{\phi_1}, \ldots, \dd{\phi_n}\}$.
\end{remark}
\begin{remark}
  Un $\R^{n}$-differenziale è un differenziale di una funzione con dominio $\R^{n}$. Quindi $d_x x_i$ è una base per lo spazio duale a quello delle derivazioni.
\end{remark}

Anche le coordinate dei vettori cotangenti si trasformano in maniera ben definita in un cambio di carte. Questa trasformazione è però inversa rispetto a quella per i tangenti.
\begin{theorem} 
  Sia $X$ una varietà e siano $(U,\phi)$ e $(V,\psi)$ due carte. Sia $x \in  U \cap V$ e sia $\alpha \in  T_x^* X$. Siano $u^* \in \R^{n}$ e $v^* \in  \R^{n}$ i corrispondenti di $\alpha$ secondo $\phi$ e $\psi$, rispettivamente. Allora, dette $u^*_i$ e $v^*_j$ le rispettive componenti, e detta $F^{\phi\psi}:\R^{n} \to \R^{n}$ la funzione di transizione, con componenti $F^{\phi \psi}_i$, vale \begin{equation} \label{eq:cvcTrans}
  u^*_i = \sum_{j=1}^n \pdv{F^{\phi \psi}_i}{x_j} v^*_j
  \end{equation} 
\end{theorem}

Identificando spazi tangenti e spazi delle derivazioni, una generica $1$-forma è associata alla combinazione lineare di differenziali \begin{equation*}
d_x = \sum_{j=1}^{n} a^*_j(x)\, d_x x_j
\end{equation*} 
dove $a_j^*$ è una funzione differenziabile da $\R^{n}$ a $\R$. Da ciò segue che, denotando la funzione di transizione con $\vec{y}(\vec{x})$, l'\autoref{eq:cvcTrans} diventa il teorema del differenziale totale \begin{equation*}
d_x y_i = \sum_{j=1}^{n} \pdv{y_i}{x_j}\, d_x x_j
\end{equation*} 

È possibile costruire un fibrato anche raccogliendo gli spazi cotangenti.

\begin{definition}
  Sia $X$ una varietà, si dice \dfn{fibrato cotangente} $T^*X$ l'insieme delle coppie $(x,\alpha)$ con $x \in X$ e $\alpha \in T^*_x X$, con l'atlante definito in maniera analoga a quanto fatto per il fibrato tangente nella \autoref{def:tanBundle}.
\end{definition}

\section{Forme differenziali}
Per le varietà come considerate finora non è definito nessun concetto analogo al volume. Ciò diventa possibile definendo le forme differenziali.

\begin{definition}
  Sia $V$ uno spazio vettoriale, si dice \dfn{$k$-forma} una mappa $\alpha: V^k \to \R$ con le due seguenti proprietà:
  \begin{enumerate}
    \item \dfn{multilinearità}: per ogni $v_1, \ldots, v_k \in V$ e $\lambda,\mu \in \R$, \begin{equation*}
      \alpha(v_1, \ldots, \lambda v_i + \mu v'_i, \ldots, v_n) = \lambda \alpha(v_1, \ldots, v_i, \ldots, v_n) + \mu \alpha(v_1, \ldots, v'_i, \ldots, v_n)
    \end{equation*} 
    \item \dfn{alternanza}: per ogni $v_1, \ldots, v_k \in V$ e $i\neq j$, \begin{equation*}
    \alpha(v_1, \ldots, v_i, \ldots, v_j, \ldots, v_n) = 
    - \alpha(v_1, \ldots, v_j, \ldots, v_i, \ldots, v_n)
    \end{equation*} 
  \end{enumerate}
\end{definition}

Si può ottenere una $k$-forma con $k$ arbitrario da $k$ $1$-forme sfruttando l'operazione seguente:
\begin{definition}
  Sia $V$ uno spazio vettoriale e siano $\alpha_1, \ldots, \alpha_k$ $1$-forme su di esso, si dice \dfn{prodotto esterno} di $\alpha_1, \ldots, \alpha_k$ la $k$-forma che agisce su $v_1, \ldots, v_k \in V$ secondo \begin{equation*}
  (\alpha_1 \wedge \ldots \wedge \alpha_k) (v_1, \ldots, v_k) = \det \pmqty{\alpha_1 (v_1) & \ldots & \alpha_1 (v_k) \\
          \vdots & \ddots & \vdots \\
          \alpha_k (v_1) & \ldots & \alpha_k (v_k)}
  \end{equation*} 
\end{definition}
\begin{remark}
  Per le proprietà dei determinanti, l'operazione di prodotto esterno è multilineare negli $\alpha_j$ e, se $\alpha$ è una $1$-forma, vale $\alpha \wedge \alpha = 0$.
\end{remark}

Si dimostra il seguente teorema: \begin{theorem} \label{thm:kformBase}
  Sia $V$ uno spazio vettoriale. Lo spazio delle $k$-forme da $V$ ad $\R$ è lo span dell'insieme di prodotti esterni delle $1$-forme su $V$. Se $e_i$ è una base di $V$ e $x_i$ è la sua base duale, lo spazio delle $k$-forme ammette inoltre una base formata da tutte le $k$-forme \begin{equation*}
  x_{i_1} \wedge \ldots \wedge x_{i_k}
  \end{equation*}
  tali che $i_1 < \ldots < i_k$.
\end{theorem}
\begin{remark}
  Geometricamente, questa forma corrisponde al volume della proiezione del parallelepipedo $k$-dimensionale formato dai $k$ vettori su cui agisce la forma sul piano $k$-dimensionale individuato da $e_{i_1},\ldots,e_{i_k}$.
\end{remark}
\begin{remark} \label{rem:volumeForm}
  In particolare, quindi, se $V$ è di dimensione $n$, per $k=n$ si ottiene che ogni $n$-forma su $V$ è multipla di $x_1 \wedge \ldots \wedge x_n$.
\end{remark}

È possibile estendere il prodotto esterno a un'operazione tra forme di ordini $k$ e $l$ generici.
\begin{definition}
  Sia $V$ uno spazio vettoriale. Si dice \dfn{prodotto esterno} di una $k$-forma $\alpha$ e una $l$-forma $\beta$ la $k+l$-forma su $V$ $\alpha \wedge \beta$ che agisce sui vettori $v_1, \ldots, v_k, v_{k+1}, \ldots, v_{k+l}$ secondo
\begin{equation*}
(\alpha \wedge \beta) (v_1, \ldots, v_k, v_{k+1}, \ldots, v_{k+l}) = \sum (-1)^{\nu}\, \alpha(v_{i_1}, \ldots, v_{i_k})\; \beta(v_{j_1}, \ldots, v_{j_l})
\end{equation*} 
dove $(i_1, \ldots, i_k, j_1, \ldots, j_l)$ è una permutazione di $(1, \ldots, k+l)$ con $i_1 < \ldots < i_k$ e $j_1 < \ldots < j_l$, e $\nu$ è $1$ se questa permutazione è dispari, $0$ se è pari.
\end{definition}

Il prodotto esterno generalizzato si comporta come atteso nel caso in cui i suoi argomenti siano prodotti di $1$-forme.
\begin{theorem}
  Sia $V$ uno spazio vettoriale. Sia $\wedge$ il prodotto esterno generalizzato e $\overline{\wedge}$ il prodotto esterno tra $1$-forme. Allora se $\alpha_1, \ldots, \alpha_k$ e $\beta_1, \ldots, \beta_l$ sono $1$-forme su $V$ \begin{equation*}
  (\alpha_1 \overline{\wedge} \ldots \overline{\wedge} \alpha_k) \wedge (\beta_1 \overline{\wedge} \ldots \overline{\wedge} \beta_l) = \alpha_1 \overline{\wedge} \ldots \overline{\wedge} \alpha_k \overline{\wedge} \beta_1 \overline{\wedge} \ldots \overline{\wedge} \beta_l
  \end{equation*} 
\end{theorem}

Finora la teoria delle forme differenziali è stata tenuta separata da quella delle varietà. Le due possono essere unite generalizzando la \autoref{def:1formCvc} a forme di generico ordine $k$. 
\begin{definition}
  Sia $X$ una varietà, si dice \dfn{k}-forma differenziale un'applicazione differenziabile $\alpha: x \in X \mapsto \alpha_x$, dove $\alpha_x$ è una $k$-forma definita su $T_x X$, tale che l'applicazione tra varietà \begin{equation*}
    \alpha': (x, \gamma_1, \ldots, \gamma_k) \in T^k X \longmapsto \alpha_x(\gamma_1, \ldots, \gamma_k) \in \R
  \end{equation*} 
  sia differenziabile. Qui $T^k X$ è l'insieme di coppie $(x, \gamma_1, \ldots, \gamma_k)$, dove $\gamma_1, \ldots,\gamma_k \in  T_x X$. Questo insieme generalizza il fibrato tangente di $X$ e, definendo l'atlante in maniera analoga a quanto fatto nella \autoref{def:tanBundle}, è anch'esso una varietà. 
\end{definition}
% \begin{remark}
%   Con \textquotedblleft differenziabile\textquotedblright\ in questa definizione si intende la caratteristica seguente. Sia $(U, \phi)$ una carta su $X$ e si usi l'identificazione $U \simeq U(\phi)$, in modo da scrivere le funzioni componenti di $\phi$ come $x_j: U \to \R$. Per ogni $y \in U$, $T^*_y X$ si può identificare con $\R^{n}$ tramite la base $\dd_y x_j$, che è duale a quella data da $\phi$ a $T_x X$. Per il \autoref{thm:kformBase} quindi esiste una base per lo spazio delle $k$-forme su ciascun $T_y X$ formata da tutte le $k$-forme $\dd_y x_{i_1} \wedge \ldots \wedge \dd_y x_{i_k}$ tali che $i_1 < \ldots < i_k < n$. Una generica $k$-forma in $y$ si esprime quindi come \begin{equation*}
%   \alpha_y = \sum_{i_1 < \ldots < i_k < n} a_{i_1\ldots i_k}\; \dd_y x_{i_1} \wedge \ldots \wedge \dd_y x_{i_k}
%   \end{equation*} 
%   e, se si introduce la dipendenza da $y$, \begin{equation*}
%     \alpha_y = \sum_{i_1 < \ldots < i_k} a_{i_1\ldots i_k}(y)\ \dd_y x_{i_1} \wedge \ldots \wedge \dd_y x_{i_k}
%     \end{equation*}
%   $\alpha:y\mapsto \alpha(y)$ si dice \dfn{differenziabile} se $a_{i_1\ldots i_k < n}(y): X\to \R$ lo è.
% \end{remark}
\begin{remark}
  Lo spazio delle $k$-forme differenziali su una varietà $X$ è uno spazio vettoriale con le operazioni punto per punto, e si denota con $\Omega^k (X)$. Anche il prodotto esterno di forme differenziali è definibile punto per punto.
\end{remark}

Siccome le $k$-forme differenziali ammettono in ogni punto una base $T_y X$ formata da tutte le $k$-forme $\dd_y x_{i_1} \wedge \ldots \wedge \dd_y x_{i_k}$ tali che $i_1 < \ldots < i_k < n$, vale il seguente teorema.
\begin{theorem}
  Sia $X$ una varietà $n$-dimensionale, ogni $k$-forma differenziale $\alpha: y \mapsto \alpha_y$ su $X$ si può esprimere univocamente nelle basi locali $x_1, \ldots, x_n \simeq \phi_1, \ldots, \phi_n$ date da una carta $(U, \phi)$, con $y \in U$, come 
  \begin{equation*}
    \alpha_y = \sum_{i_1 < \ldots < i_k < n} a_{i_1\ldots i_k}(y)\ \dd_y x_{i_1} \wedge \ldots \wedge \dd_y x_{i_k}
  \end{equation*}
\end{theorem}

L'operazione duale al push-forward dei vettori lungo un'applicazione $f$ è il pull-back delle forme differenziali contro $f$.
\begin{definition}
  Siano $X,Y$ due varietà, sia $\alpha \in \Omega^k (Y)$ e sia $f:X\to Y$ un'applicazione differenziabile. Si dice \dfn{pull-back} $f^*(\alpha) \in  \Omega^K(X)$ la $k$-forma differenziale $f^* \alpha$ su $X$ definita per $v_1, \ldots, v_k \in T_x X$, con $x \in X$, da \begin{equation*}
  (f^*\alpha)_x\, (v_1, \ldots, v_k) = \alpha_{f(x)}\big((D_x f)(v_1), \ldots, (D_x f)(v_n)\big)
  \end{equation*}  
\end{definition}

L'espressione in coordinate del pull-back di una forma differenziale rivela lo stretto legame tra forme differenziali e integrazione.
\begin{theorem} \label{thm:varChange}
  Siano $X,Y$ due varietà $n$-dimensionali, $f:X\to Y$ un'applicazione differenziabile e $\alpha \in  \Omega^n(Y)$. Siano $(U, \phi)$ e $(V,\psi)$ carte su $X$ e $Y$ rispettivamente, si identifichino $U$ con $\phi(U)$ e $V$ con $\psi(V)$ in modo che $f$ sia rappresentata da $y_i = f_i(x_1, \ldots, x_n)$ e $\alpha$ da $\alpha = a(y)\ \dd_y y_1\wedge \ldots \wedge \dd_y y_n$. Allora $f^* \alpha$ è rappresentata da \begin{equation*}
  (f^* \alpha)_x = (a \circ f)(x) \det(\mathsf{D_x f}\,)\dd_x x_1 \wedge \ldots \wedge \dd_x x_n
  \end{equation*}
  dove $\mathsf{D_x f}$ è la matrice che rappresenta $D_x f$ identificando $T_x X$ e $T_{f(x)}Y$ con $\R^{n}$.
\end{theorem}
\begin{remark}
  A meno del segno del determinante, questa è la formula del cambio di variabili. Se il segno del determinante è positivo, e quindi la formula si applica esattamente, si dice che $f$ \dfn{conserva l'orientazione}. Si dice \dfn{orientazione} di una varietà un atlante tale che tutte le funzioni di transizione conservino l'orientazione, se esiste.
\end{remark}

Grazie al concetto di pull-back è in effetti possibile definire l'integrale di una forma differenziale sfruttando l'integrazione in $\R^{n}$.
\begin{definition}
  Sia $X$ una varietà $n$-dimensionale e sia $\alpha \in \Omega^k(X)$. Sia $D$ un poliedro limitato e convesso $k$-dimensionale in $\R^{k}$, sia $\mathrm{Or}$ l'orientazione di $\R^k$ e sia $f:D\to X$ un'applicazione differenziabile. Si dice \dfn{poliedro singolare $k$-dimensionale} la terna $\sigma = (D,f,\mathrm{Or})$, identificata con $\sigma = f(D) \subset X$. Si dice \dfn{integrale} di $\alpha$ su $\sigma$ l'integrale del suo pullback su $D$: \begin{equation*}
  \int\limits_{\sigma} \alpha = \int\limits_{D} (f^* \alpha) = \int\limits_{y \in D} a(y) \dd{x_1} \ldots \dd{x_k}
  \end{equation*}
  dove $a: D \to \R$ è la funzione tale che in ogni $y \in D$ sia $(f^* \alpha)_y = a(y) \dd{x_1} \wedge \ldots \wedge \dd{x_k}$.
\end{definition}
\begin{remark}
  L'integrale è ben definito, siccome per il \autoref{thm:varChange} il membro di destra non dipende dalle coordinate usate, purché non cambi l'orientazione.
\end{remark}
\begin{remark}
  Nella maggior parte dei casi, $f$ sarà $\phi^{-1}$, l'inversa della funzione di coordinate di una qualche carta $(U,\phi)$ tale che $\sigma \subset U$.
\end{remark}

Dal \autoref{thm:varChange} segue inoltre una generalizzazione del teorema di cambio di variabili.
\begin{theorem}
  Siano $X$ una varietà $n$-dimensionale orientata e $\alpha$ una $n$-forma differenziale su $X$ con supporto compatto, l'integrale di $\alpha$ su $X$ esiste, l'integrazione è lineare in $\alpha$ e per ogni diffeomorfismo $f:X\to Y$, con $Y$ altra varietà differenziabile,
  \begin{equation*}
  \int\limits_Y f^*(\alpha) = \int\limits_X \alpha
  \end{equation*} 
\end{theorem}

Tramite l'integrazione è possibile definire anche un'operazione di derivazione di $k$-forme.

\begin{definition}
  Sia $X$ una varietà e sia $\alpha \in \Omega^k(X)$. Si dice \dfn{derivata esterna} di $\alpha$, indicata con $\dd{a}$, la parte principale, $(k+1)$-lineare, dell'integrale $\int_{\partial \Pi} \alpha$, dove $\Pi$ è il parallelepipedo $k+1$-dimensionale delimitato dai vettori $v_1, \ldots, v_{k+1} \in \R^{n}$ corrispondenti in una carta $(U, \phi)$ ai vettori $\gamma_1, \ldots, \gamma_{k+1}$ su cui agisce $\dd\alpha$. Più precisamente, se per $\Pi$ delimitato da $\epsilon v_1, \ldots, \epsilon v_{k+1}$ si ha \begin{equation*}
    \int\limits_{\partial \Pi} \alpha = \epsilon^{k+1} A(v_1, \ldots, v_{k+1}) + \mathcal{O}\big(\epsilon^{k+2}\big)
  \end{equation*}
  allora $\dd\alpha$ è definita da \begin{equation*}
  \dd{\alpha}(\gamma_1, \ldots, \gamma_{k+1}) = A(v_1, \ldots, v_{k+1})
  \end{equation*} 
\end{definition}
\begin{remark}
  Si dimostra che in questo modo la derivata esterna è ben definita, ovvero non dipende dalla carta tramite cui si identificano i $\gamma_j$ e i $v_j$.
\end{remark}

\begin{theorem} \label{thm:derivCoords}
  Sia $X$ una varietà e sia $\alpha \in \Omega^k(X)$, rappresentata nella carta $(U, \phi)$ da \begin{equation*}
    \alpha_y = \sum_{i_1 < \ldots < i_k} a_{i_1\ldots i_k}(y)\ \dd_y x_{i_1} \wedge \ldots \wedge \dd_y x_{i_k}
    \end{equation*}
    Allora $\dd{\alpha}$ è rappresentato nella stessa carta da
    \begin{equation*}
      \alpha_y = \sum_{i_1 < \ldots < i_k} \sum_{j=1}^n \pdv{a_{i_1\ldots i_k}}{x_j}()(y)\ \dd_y x_{j} \wedge \dd_y x_{i_1} \wedge \ldots \wedge \dd_y x_{i_k}
      \end{equation*}
\end{theorem}

Per la derivata esterna e il pull-back valgono inoltre le seguenti proprietà:
\begin{theorem}
  Siano $X,Y$ varietà e siano $\alpha \in \Omega^k(Y), bb \in \Omega^l(Y)$. Sia $f:X\to Y$ un'applicazione differenziabile. Allora:
  \begin{enumerate}
    \item $f^*(\dd{\alpha}) = df^*(\alpha)$
    \item $f^*(\alpha \wedge \beta) = f^*(\alpha) \wedge f^*(\beta)$
    \item $\dd (\alpha \wedge \beta) = \dd{\alpha} \wedge \beta + (-1)^k \alpha \wedge \dd{\beta}$
    \item $\dd{\dd{\alpha}} = 0$
  \end{enumerate}
\end{theorem}

Tramite la derivata esterna è possibile generalizzare il concetto di campo vettoriale chiuso.
\begin{definition}
  Si dice \dfn{chiusa} una forma differenziale $\alpha$ tale che $\dd \alpha = 0$. 
\end{definition}

È inoltre possibile applicare il concetto di non degenerazione:
\begin{definition}
  Si dice \dfn{non degenere} una $2$-forma differenziale $\alpha$ su una varietà $X$ tale che, se $\alpha_x (\gamma, \delta) = 0$ per ogni $\gamma \in T_x X$, con $x \in  X$, allora $\delta = 0$.
\end{definition}

Combinando questi due requisiti, si ottiene un tipo di forma differenziale che sarà fondamentale per ottenere lo scopo prefissato alla fine dello scorso capitolo, ovvero liberare la meccanica dalle coordinate.
\begin{restatable}{definition}{symplecticForm}
  Si dice \dfn{forma simplettica} una $2$-forma differenziale $\omega$ chiusa e non degenere. Si dice \dfn{varietà simplettica} una varietà $2n$-dimensionale su cui è definita una forma simplettica.
\end{restatable}